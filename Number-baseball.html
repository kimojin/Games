<!DOCTYPE html>
<html lang = "en">

<head>
	<meta charset = "UTF-8" />
	<title>
		Number Baseball
	</title>
	
	<style>
		input[type = "text"]{
			width: 20px;
			height: 20px;
			text-align: center;
			font-family: Comic Sans MS;
			font-size: 16px;
		}
	</style>
</head>

<body>
	<h1>
		Number Baseball
	</h1>
	<hr>
	
	<form name = "inputs">
		<script>
			function autoTab(current,to){
				if (current.getAttribute && current.value.length==current.getAttribute("maxlength")){
					to.focus();
				}
			}
		</script>
		
		<input type = "button" value = "New Game" onclick = "newGame()">
		<div id = "totalRound"></div>
		<br>
		<label for = "digit-1"><b>Enter Numbers:</b></label>
		<input type="text" id="digit-0" maxlength="1" oninput = "autoTab(this, document.getElementById('digit-1'))"/>
		<input type="text" id="digit-1" maxlength="1" oninput = "autoTab(this, document.getElementById('digit-2'))"/>
		<input type="text" id="digit-2" maxlength="1" oninput = "autoTab(this, document.getElementById('digit-3'))"/>
		<input type="text" id="digit-3" maxlength="1"/>
		<input type = "button" id = "pitchButton" value = "pitch" onclick = "pitchBall()">
	</form>
	
	<hr>
	
	<div id = "display"></div>
	
	<script>
		var arrNo = new Array();
		var arrAns = new Array();
		var arrInput = new Array();
		var round, content;
		
		arrAns.length = 4;
		
		newGame();
		
		document.getElementById("digit-3").addEventListener("keypress", function(e){
			if(e.keyCode == 13){
				pitchBall();
			}
		});
		
		function newGame(){
			resetData();
			resetInput();
			document.getElementById('digit-0').focus();
			
			return;
		}
		
		function resetData(){
			for(let i = 0; i < 10; i++){
				arrNo[i] = i;
			}
			
			round = 0;
			content = "";
			document.getElementById("totalRound").innerHTML = `total round: ${round}`;
			document.getElementById("display").innerHTML = "";
			
			for(let i = 0; i < arrAns.length; i++){
				let r = Math.floor(Math.random() * (10 - i));
				arrAns[i] = arrNo[r];
				
				for(let j = r; j < arrNo.length - 1; j++){
					arrNo[j] = arrNo[j + 1];
				}
				
				arrNo.length -= 1;
			}
			
			return;
		}
		
		function resetInput(){
			for(let i = 0; i < arrAns.length; i++){
				document.getElementById("digit-" + i).value = "";
			}
			
			return;
		}
		
		function pitchBall(){
			let strike = 0, ball = 0;  
			++round;
			
			for(let i = 0; i < arrAns.length; i++){
				arrInput[i] = document.getElementById("digit-" + i).value;
			}
			
			if(validateInput()){
				resetInput();
				return;
			}
			
			for(let i = 0; i < arrAns.length; i++){
				arrInput[i] = Number(arrInput[i]);
			}
			
			for(let i = 0; i < arrAns.length; i++){
				for(let j = 0; j < arrAns.length; j++){
					if(arrInput[i] == arrAns[j]){
						if(i == j)
							++strike;
						else
							++ball;
							
						break;
					}
				}
			}
			
			displayResult(strike, ball);
			resetInput();
			document.getElementById('digit-0').focus();
			
			return;
		}
		
		function validateInput(){
			for(let i = 0; i < arrAns.length; i++){
				if(arrInput[i] === ""){
					alert("You must Enter 4 numbers!");
					
					return 1;
				}
				
				if(isNaN(Number(arrInput[i]))){
					alert("You must Enter a number!");
					
					return 1;
				}
				
				for(let j = 1; i + j < arrAns.length; j++){
					if (arrInput[i] == arrInput[i + j]){
						alert("The digits cannot be repeated!");
						
						return 1;
					}
				}
			}
			
			return;
		}
		
		function displayResult(strike, ball){
			for(let i = 0; i < arrAns.length; i++){
				content += arrInput[i] + "&nbsp";
			}
			
			if(strike == arrAns.length)
				content += `:<br>${arrAns.length} Strike! You won the game.<br>total round = ${round}<br><br>`;
			else if((strike == 0) && (ball == 0))
				content += `:<br>Out!<br><br>`;
			else
				content += `:<br>${strike} Strike, ${ball} Ball<br><br>`;
			
			
			
			document.getElementById("totalRound").innerHTML = `total round: ${round}`;
			document.getElementById("display").innerHTML = content;
			
			return;
		}
		
	</script>
</body>

</html>